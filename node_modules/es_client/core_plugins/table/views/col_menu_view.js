if (typeof define !== 'function') { var define = require('amdefine')(module) }
define( function(require,exports,module)
{
    const MenuView = require('./menu_view').View;

    class ColMenuView extends MenuView {
        constructor(params) {
            super(params);
            this.addAction("add_column",    this.addCol.bind(this));
            this.addAction("remove_column", this.deleteCol.bind(this));
            this.addAction("sort_row",      this.sortRows.bind(this));
        }

        sortRows(){
            this.es_controller.table.getSheet().sortRows(this.col_id);
         }

        addCol(){
            let col_position = this.es_controller.table.getSheet().indexForCol(this.current_element);
            if(col_position == -1) return;
            this.es_controller.table.getSheet().insertCol(col_position);
        }

        deleteCol(){
            this.es_controller.table.getSheet().deleteCol(this.current_element);
        }
    }

    module.exports.View = ColMenuView;
});